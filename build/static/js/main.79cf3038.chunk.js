(this.webpackJsonpreact_client=this.webpackJsonpreact_client||[]).push([[0],{125:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),o=n.n(r),c=n(13),i=n.n(c),s=(n(125),n(15)),l=n(7),u=n(97),d=n(19),p=n(79),m=n(83),j=n(11),b=n.n(j),h=n(18),f=n(21),O=n(95),g=n.n(O),v=n(94),x=n.n(v),y=n(178),w=n(179),k=n(180),C=n(6),S=n(205),N=Object(C.a)((function(e){return Object(S.a)({head:{backgroundColor:e.palette.common.black,color:e.palette.common.white},body:{fontSize:14,padding:0,maxWidth:"10ch"}})}))(y.a),L=Object(C.a)((function(e){return Object(S.a)({root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"& input":{backgroundColor:"inherit",paddingLeft:0}}})}))(w.a);function _(e){var t=Object(r.useState)({Amount:""}),n=Object(s.a)(t,2),o=n[0],c=n[1];function i(e,t){return Object(a.jsx)("datalist",{id:t,children:e.map((function(e){return Object(a.jsx)("option",{value:e.name},e.id)}))})}function u(e){var t=e.target,n=t.name,a=t.value;c(Object(l.a)(Object(l.a)({},o),{},Object(f.a)({},n,a)))}return Object(r.useEffect)((function(){c(e.entry)}),[e.entry]),Object(a.jsxs)(L,{children:[e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){var n,r,c,s,l,d,p,m,j,b;return Object(a.jsxs)(N,{children:["Amount"===t.name?Object(a.jsx)("span",{children:"$"}):null,Object(a.jsx)("input",{name:t.name,onBlur:function(t){e.handleChange(t,e.i)},onChange:u,className:"tableInput",value:o[t.name]||"",list:t.name,style:{width:"80%"}}),"Source"===t.name&&(null===(n=e.dataLists)||void 0===n?void 0:n.source)?i(null===(r=e.dataLists)||void 0===r?void 0:r.source,t.name):null,"Person"===t.name&&(null===(c=e.dataLists)||void 0===c?void 0:c.person_earner)?i(null===(s=e.dataLists)||void 0===s?void 0:s.person_earner,t.name):null,"Narrow_category"===t.name&&(null===(l=e.dataLists)||void 0===l?void 0:l.narrow_category)?i(null===(d=e.dataLists)||void 0===d?void 0:d.narrow_category,t.name):null,"Broad_category"===t.name&&(null===(p=e.dataLists)||void 0===p?void 0:p.broad_category)?i(null===(m=e.dataLists)||void 0===m?void 0:m.broad_category,t.name):null,"Vendor"===t.name&&(null===(j=e.dataLists)||void 0===j?void 0:j.vendor)?i(null===(b=e.dataLists)||void 0===b?void 0:b.vendor,t.name):null]})})),Object(a.jsx)(N,{children:Object(a.jsx)(k.a,{color:"primary",onClick:function(){return e.handleUpdate(e.i)},children:Object(a.jsx)(x.a,{})})}),Object(a.jsx)(N,{children:Object(a.jsx)(k.a,{"aria-label":"delete",color:"secondary",onClick:function(){return e.deleteEntry(o.entry_id||o.id)},children:Object(a.jsx)(g.a,{})})})]})}function E(e){return Object(a.jsx)("tbody",{children:Object(a.jsx)("tr",{children:e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){return Object(a.jsxs)("td",{children:["Amount"===t.name?Object(a.jsx)("span",{children:"$"}):null,Object(a.jsx)("span",{className:"tableInput",children:e.entry[t.name]||""})]},e.i+t.name)}))})})}var I=n(183),A=n(185),T=n(182),D=n(184),B=n(72),P=n(181);function U(e){var t=Object(r.createRef)();Object(r.useEffect)((function(){t.current&&t.current.scrollIntoView({behavior:"smooth"})}),[]);var n=Object(C.a)((function(e){return Object(S.a)({head:{backgroundColor:e.palette.primary.main,color:e.palette.common.white}})}))(y.a),o=Object(P.a)((function(e){return Object(S.a)({table:{minWidth:650}})}))();return Object(a.jsx)(T.a,{component:B.a,children:Object(a.jsxs)(I.a,{className:o.table,ref:t,children:[Object(a.jsx)(D.a,{children:Object(a.jsxs)(w.a,{children:[e.state.schema.fields.filter((function(e){return!e.name.includes("id")})).map((function(e){return Object(a.jsx)(n,{children:e.name.replace("_"," ")},e.name)})),Object(a.jsx)(n,{children:Object(a.jsx)("span",{children:"Save"})}),Object(a.jsx)(n,{children:Object(a.jsx)("span",{children:"Delete"})})]})}),Object(a.jsx)(A.a,{className:"tableBody",children:e.state.data.map((function(t,n){return"pivot"===e.form?Object(a.jsx)(E,{entry:t,i:n,fields:e.state.schema.fields},t.entry_id||t.id):Object(a.jsx)(_,{entry:t,i:n,fields:e.state.schema.fields,handleChange:e.handleChange,handleUpdate:e.handleUpdate,dataLists:e.dataLists,deleteEntry:e.deleteEntry},n)}))})]})})}function F(e,t){if(401===e.status)throw new Error("Unauthorized");if(200!==e.status)throw new Error("Error! "+e.status);return"json"===t?e.json():e.text()}var z,G={expenses:function(e,t){return fetch("/api/expenses/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"json")}))},postExpenses:function(e,t){return fetch("/api/expenses/",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return F(e,"text")}))},postBatchExpenses:function(e,t){return fetch("/api/expenses/batch",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return F(e,"text")}))},postIncome:function(e,t){return fetch("/api/income/",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return F(e,"text")}))},postBatchIncome:function(e,t){return fetch("/api/income/batch",{method:"POST",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return F(e,"text")}))},deleteExpenses:function(e,t){return fetch("/api/expenses/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"text")}))},updateExpenses:function(e,t){return fetch("/api/expenses/".concat(t.entry_id),{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return F(e,"text")}))},income:function(e,t){return fetch("/api/income/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"json")}))},updateIncome:function(e,t){return fetch("/api/income/".concat(t.id),{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return F(e,"text")}))},deleteIncome:function(e,t){return fetch("/api/income/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"text")}))},pivot:function(e,t){return fetch("/api/expenses/pivot/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"json")}))},dataList:function(e){return fetch("/api/datalists",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"json")}))},login:function(e){return fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return F(e,"json")}))},checkAuth:function(e){return fetch("/auth/checkAuth",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return F(e,"json")}))}},M=n(98);function R(){return(R=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(M.a)("pendingFinances",2,{upgrade:function(e){e.createObjectStore("expenses",{autoIncrement:!0}),e.createObjectStore("income",{autoIncrement:!0})}});case 2:z=e.sent,navigator.onLine&&$();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e,t){return J.apply(this,arguments)}function J(){return(J=Object(h.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.put(t,n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return V.apply(this,arguments)}function V(){return(V=Object(h.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.clear("expenses");case 3:return e.next=5,z.clear("income");case 5:return e.abrupt("return","pendingFinances cleared!");case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function $(){return Y.apply(this,arguments)}function Y(){return(Y=Object(h.a)(b.a.mark((function e(){var t,n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.prev=1,e.next=4,z.getAll("expenses");case 4:if(!((n=e.sent).length>0)){e.next=9;break}return e.next=8,G.postBatchExpenses(t,n);case 8:z.clear("expenses");case 9:return e.next=11,z.getAll("income");case 11:if(!((a=e.sent).length>0)){e.next=16;break}return e.next=15,G.postBatchIncome(t,a);case 15:z.clear("income");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}window.addEventListener("online",$);var K=n(186),q=n(188),Q=n(135),X=n(208),Z=n(195),ee=n(194),te=n(210),ne=n(201),ae=n(211),re=n(189),oe=n(70),ce=n(25),ie=n(200);function se(e){var t,n=o.a.useContext(_e),c=n.Auth,i=n.setAuth,u=n.setAlertState,d={Date:new Date(Date.now()),Amount:NaN,person_id:NaN,broad_category_id:NaN,narrow_category_id:NaN,vendor:"",notes:""},p=Object(r.useState)(d),m=Object(s.a)(p,2),j=m[0],O=m[1],g=Object(r.useState)({name:"",id:NaN}),v=Object(s.a)(g,2),x=v[0],y=v[1],w=[{name:"Groceries",id:6,narrowCategories:[{name:"Food",id:10},{name:"Alcohol",id:49},{name:"Entertaining",id:7}]},{name:"Health and Body",id:12,narrowCategories:[{name:"Toiletries",id:27},{name:"Make-up",id:51},{name:"Drugs/Supplements",id:273},{name:"Doctors Visits",id:24},{name:"Gym",id:34},{name:"Essential Oils",id:58},{name:"Massages/Body Care",id:41}],person:!0},{name:"Work",id:8,narrowCategories:[{name:"Road Food Out",id:20},{name:"Road Groceries",id:37},{name:"Road Coffee",id:21},{name:"Business Food",id:70},{name:"Scores",id:68},{name:"Office Supplies",id:11},{name:"Plane Tickets",id:18},{name:"Transportation",id:9},{name:"Union Dues",id:55},{name:"Dry Cleaning",id:14},{name:"Concert Tickets",id:655},{name:"Lessons/Coachings",id:69},{name:"Application fees",id:61},{name:"Pianist Fees",id:656}],person:!0},{name:"Eating Out",id:3,narrowCategories:[{name:"Date",id:28},{name:"Friends",id:3},{name:"Snacks",id:17},{name:"On the Run",id:8},{name:"Coffee",id:30},{name:"Ordering in",id:48}]},{name:"Home Goods",id:9,narrowCategories:[{name:"Kitchen",id:12},{name:"Decorating",id:29},{name:"Furniture",id:16},{name:"Paper Products/Cleaning",id:15},{name:"Office Supplies",id:11},{name:"Hobbies/Creative",id:23},{name:"Linens",id:201}]},{name:"New York Home",id:1,narrowCategories:[{name:"Rent",id:40},{name:"Internet",id:1},{name:"Electricity",id:26}]},{name:"Seattle Home",id:7,narrowCategories:[{name:"Mortgage",id:39},{name:"HOA",id:38},{name:"Taxes",id:657},{name:"Internet",id:1},{name:"Electricity",id:26},{name:"Manager/Maintanence",id:42},{name:"Insurance",id:134}]},{name:"Clothes",id:11,person:!0},{name:"Laundry",id:4,narrowCategories:[{name:"Laundry",id:4},{name:"Dry Cleaning",id:14}]},{name:"Entertainment",id:14,narrowCategories:[{name:"Live Shows",id:32},{name:"Movies",id:44},{name:"Museums",id:53},{name:"Books",id:36},{name:"Home (Netflix, Spotify, Amazon, Movie Rentals)",id:46},{name:"Newspaper/Magazine",id:47}]},{name:"Philanthropy",id:17},{name:"Electronics",id:5,narrowCategories:[{name:"Phone Bill",id:33},{name:"Computers",id:588},{name:"Accessories",id:31},{name:"Cloud Storage Fees",id:6}]},{name:"Gifts",id:13},{name:"Transportation",id:2,narrowCategories:[{name:"Gas",id:22},{name:"Repairs",id:577},{name:"Insurance",id:134},{name:"Bike",id:567},{name:"Subway",id:35},{name:"Taxi/Lyft",id:5},{name:"Car Rental",id:2},{name:"Seattle Airplanes",id:276},{name:"Parking",id:209}]},{name:"Maggie",id:10,narrowCategories:[{name:"Food",id:10},{name:"Litter",id:13},{name:"Vet Bills",id:275},{name:"Toys",id:60}]},{name:"Travel/Leisure",id:16,narrowCategories:[{name:"Planes",id:62},{name:"Ground Transportation",id:52},{name:"Food",id:10},{name:"Experiences",id:64},{name:"Lodging",id:43}]},{name:"Legal",id:19,narrowCategories:[{name:"Documents",id:202},{name:"Services",id:63}]},{name:"Student Loans",id:15},{name:"Education",id:18,person:!0},{name:"Theo",id:7,narrowCategories:[{name:"Baby sitting",id:274},{name:"Toys",id:60}]}];function k(e){var t=e.target.name;if(O(Object(l.a)(Object(l.a)({},j),{},Object(f.a)({},t,e.target.value))),"broad_category_id"===t){var n=w.filter((function(t){return t.id===e.target.value}))[0];y(n)}}function C(){return(C=Object(h.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),j.Date&&j.Amount&&j.broad_category_id&&j.vendor){e.next=4;break}return u({severity:"error",message:"Please fill out all fields",open:!0}),e.abrupt("return");case 4:return(a=Object(l.a)({},j)).Date=null===(n=a.Date)||void 0===n?void 0:n.toLocaleDateString("en-US"),e.prev=6,e.next=9,G.postExpenses(c.token,a);case 9:u({severity:"success",message:"Record Saved!",open:!0}),e.next=22;break;case 12:if(e.prev=12,e.t0=e.catch(6),"Error! 500"!==e.t0.message){e.next=19;break}return u({severity:"error",message:"Server Error! Contact Eli",open:!0}),e.abrupt("return");case 19:W("expenses",a),"Unauthorized"===e.t0.message&&i({type:"LOGOUT"}),u({severity:"warning",message:"Record Saved Locally",open:!0});case 22:return e.prev=22,O(d),y({name:"",id:NaN}),e.finish(22);case 26:case"end":return e.stop()}}),e,null,[[6,12,22,26]])})))).apply(this,arguments)}var S=o.a.useState(!1),N=Object(s.a)(S,2),L=N[0],_=N[1];Object(r.useEffect)((function(){_(!0)}));return Object(a.jsx)(K.a,{onClose:function(){_(!1)},open:L,maxWidth:"xl",children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(Q.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Log Expense"}),Object(a.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return C.apply(this,arguments)},children:[Object(a.jsx)(ce.a,{utils:oe.a,children:Object(a.jsx)(ie.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",name:"Date",label:"Date",value:j.Date,onChange:function(e){O(Object(l.a)(Object(l.a)({},j),{},{Date:e}))},KeyboardButtonProps:{"aria-label":"change date"}})}),Object(a.jsx)(X.a,{onChange:k,value:j.vendor,label:"Vendor",name:"vendor",type:"string",InputLabelProps:{shrink:!0}}),Object(a.jsx)(X.a,{onChange:k,value:j.Amount,label:"Amount",name:"Amount",type:"number",InputProps:{startAdornment:Object(a.jsx)(Z.a,{position:"start",children:"$"})},inputProps:{step:"0.01"}}),Object(a.jsxs)(ee.a,{className:e.classes.formControl,children:[Object(a.jsx)(te.a,{htmlFor:"broad_category",children:"Broad Category"}),Object(a.jsx)(ne.a,{onChange:k,value:j.broad_category_id,name:"broad_category_id",labelId:"broad_category",label:"Broad Category",children:w.map((function(e){return Object(a.jsx)(ae.a,{value:e.id,children:e.name})}))})]}),x.narrowCategories?Object(a.jsxs)(ee.a,{className:e.classes.formControl,children:[Object(a.jsx)(te.a,{htmlFor:"narrow_category",children:"Narrow Category"}),Object(a.jsx)(ne.a,{onChange:k,value:j.narrow_category_id,name:"narrow_category_id",labelId:"narrow_category",label:"Narrow Category",children:null===(t=x.narrowCategories)||void 0===t?void 0:t.map((function(e){return Object(a.jsx)(ae.a,{value:e.id,children:e.name})}))})]}):null,x.person?Object(a.jsxs)(ee.a,{className:e.classes.formControl,children:[Object(a.jsx)(te.a,{htmlFor:"person_id",children:"Person"}),Object(a.jsx)(ne.a,{onChange:k,value:j.person_id,name:"person_id",labelId:"person_id",label:"Person",children:[{name:"Alexa",id:3},{name:"Eli",id:1},{name:"Theo",id:2}].map((function(e){return Object(a.jsx)(ae.a,{value:e.id,children:e.name})}))})]}):null,Object(a.jsx)(X.a,{onChange:k,value:j.notes,label:"Notes",name:"notes",type:"string",InputLabelProps:{shrink:!0}}),Object(a.jsx)(re.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),Object(a.jsx)(re.a,{type:"button",variant:"contained",color:"secondary",onClick:function(){O(d),e.hideForms()},children:"Close"})]})]})})}function le(e){var t=o.a.useContext(_e),n=t.Auth,c=t.setAuth,i=t.setAlertState,u={date:new Date(Date.now()),amount:NaN,earner_id:NaN,source:""},d=Object(r.useState)(u),p=Object(s.a)(d,2),m=p[0],j=p[1];function O(e){var t=e.target.name;j(Object(l.a)(Object(l.a)({},m),{},Object(f.a)({},t,e.target.value)))}function g(){return(g=Object(h.a)(b.a.mark((function e(t){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),m.date&&m.amount&&m.earner_id&&m.source){e.next=4;break}return i({severity:"error",message:"Please fill out all fields",open:!0}),e.abrupt("return");case 4:return a=Object(l.a)({},m),e.prev=5,a.date=null===(r=a.date)||void 0===r?void 0:r.toLocaleDateString("en-US"),e.next=9,G.postIncome(n.token,a);case 9:i({severity:"success",message:"Record Saved!",open:!0}),e.next=22;break;case 12:if(e.prev=12,e.t0=e.catch(5),"Error! 500"!==e.t0.message){e.next=19;break}return i({severity:"error",message:"Server Error! Contact Eli",open:!0}),e.abrupt("return");case 19:W("income",a),i({severity:"warning",message:"Record Saved Locally",open:!0}),"Unauthorized"===e.t0.message&&c({type:"LOGOUT"});case 22:return e.prev=22,j(u),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[5,12,22,25]])})))).apply(this,arguments)}var v=o.a.useState(!1),x=Object(s.a)(v,2),y=x[0],w=x[1];Object(r.useEffect)((function(){w(!0)}));return Object(a.jsx)(K.a,{onClose:function(){w(!1)},open:y,maxWidth:"xl",children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(Q.a,{variant:"h5",component:"h5",className:e.classes.root,children:"Log Income"}),Object(a.jsxs)("form",{className:e.classes.root,onSubmit:function(e){return g.apply(this,arguments)},children:[Object(a.jsx)(ce.a,{utils:oe.a,children:Object(a.jsx)(ie.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",name:"Date",label:"Date",value:m.date,onChange:function(e){j(Object(l.a)(Object(l.a)({},m),{},{date:e}))},KeyboardButtonProps:{"aria-label":"change date"}})}),Object(a.jsx)(X.a,{onChange:O,value:m.source,label:"Source",name:"source",type:"string",InputLabelProps:{shrink:!0}}),Object(a.jsx)(X.a,{onChange:O,value:m.amount,label:"Amount",name:"amount",type:"number",InputProps:{startAdornment:Object(a.jsx)(Z.a,{position:"start",children:"$"})},inputProps:{step:"0.01"}}),Object(a.jsxs)(ee.a,{className:e.classes.formControl,children:[Object(a.jsx)(te.a,{htmlFor:"earner_id",children:"Person"}),Object(a.jsx)(ne.a,{onChange:O,value:m.earner_id,name:"earner_id",labelId:"earner_id",label:"Person",children:[{name:"Alexa",id:3},{name:"Eli",id:1},{name:"Rent",id:8},{name:"Sales",id:10},{name:"Gift",id:11}].map((function(e){return Object(a.jsx)(ae.a,{value:e.id,children:e.name})}))})]}),Object(a.jsx)(re.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"}),Object(a.jsx)(re.a,{type:"button",variant:"contained",color:"secondary",onClick:function(){j(u),e.hideForms()},children:"Close"})]})]})})}var ue=n(196),de=n(197),pe=n(198),me=n(134),je=n(191),be=n(206),he=n(207),fe=n(203),Oe=n(80),ge=n.n(Oe);var ve=function(){var e,t,n=o.a.useContext(_e),c=n.Auth,i=n.setAuth,u=n.setAlertState,d=Object(r.useState)({form:"expenses",year:new Date(Date.now()).getUTCFullYear(),month:new Date(Date.now()).getUTCMonth()+1}),p=Object(s.a)(d,2),j=p[0],O=p[1],g=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Person:"",id:NaN,source_id:NaN,earner_id:NaN}]}),v=Object(s.a)(g,2),x=v[0],y=v[1],w=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Vendor:"",Broad_category:"",Narrow_category:"",Person:"",Notes:"",entry_id:NaN}]}),k=Object(s.a)(w,2),C=k[0],N=k[1],L=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Broad_category:"",Narrow_category:""}]}),_=Object(s.a)(L,2),E=_[0],I=_[1],A=Object(r.useState)({source:[],person_earner:[],narrow_category:[],broad_category:[],vendor:[]}),T=Object(s.a)(A,2),D=T[0],B=T[1],F=Object(r.useState)(!1),z=Object(s.a)(F,2),M=z[0],R=z[1],W=Object(r.useState)(!1),J=Object(s.a)(W,2),V=J[0],$=J[1],Y=o.a.useState(!1),K=Object(s.a)(Y,2),q=K[0],Q=K[1];function Z(){R(!1),$(!1)}function oe(e){if(e.Date){var t=new Date(e.Date),n=t.getUTCFullYear(),a=(1+t.getUTCMonth()).toString();a=a.length>1?a:"0"+a;var r=t.getUTCDate().toString(),o=a+"/"+(r=r.length>1?r:"0"+r)+"/"+n;return e.Date=o,e}return e}function ce(e){var t=e.target.name;O(Object(l.a)(Object(l.a)({},j),{},Object(f.a)({},t,e.target.value)))}function ie(){return(ie=Object(h.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),n=j.form,Q(!0),e.next=6,G[n](c.token,j);case 6:a=e.sent,Q(!1),"pivot"!==n&&(a.data=a.data.map(oe)),e.t0=n,e.next="expenses"===e.t0?12:"income"===e.t0?14:"pivot"===e.t0?16:18;break;case 12:return N(a),e.abrupt("break",18);case 14:return y(a),e.abrupt("break",18);case 16:return I(a),e.abrupt("break",18);case 18:e.next=25;break;case 20:e.prev=20,e.t1=e.catch(0),"Unauthorized"===e.t1.message&&i({type:"LOGOUT"}),Q(!1),u({severity:"error",message:"Error Fetching Data",open:!0});case 25:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}function Oe(e,t){var n,a;switch(e){case"Person":n=D.person_earner,a="person_id";break;case"Source":n=D.source,a="source_id";break;case"Broad_category":n=D.broad_category,a="broad_category_id";break;case"Narrow_category":n=D.narrow_category,a="narrow_category_id";break;case"Vendor":n=D.vendor,a="vendor_id"}var r=n.filter((function(e){return e.name===t}))[0];return r?{id:a,dataListItem:r}:{id:null,dataListItem:null}}function ve(){return(ve=Object(h.a)(b.a.mark((function e(t,n){var a,r,o,c,s,u,d,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a=t.target,r=a.name,o=a.value,c=Object(m.a)(C.data),s=Object(l.a)(Object(l.a)({},c[n]),{},Object(f.a)({},r,o)),"Person"!==r&&"Broad_category"!==r&&"Narrow_category"!==r&&"Vendor"!==r||(u=Oe(r,o),d=u.id,p=u.dataListItem,d&&p&&(s=Object(l.a)(Object(l.a)({},s),{},Object(f.a)({},d,p.id)))),c[n]=s,N(Object(l.a)(Object(l.a)({},C),{},{data:c}))}catch(j){console.error(j),"Unauthorized"===j.message&&i({type:"LOGOUT"})}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(){return(xe=Object(h.a)(b.a.mark((function e(t,n){var a,r,o,c,i,s,u,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a=t.target,r=a.name,o=a.value,c=Object(m.a)(x.data),i=Object(l.a)(Object(l.a)({},c[n]),{},Object(f.a)({},r,o)),"Person"!==r&&"Source"!==r||(s=Oe(r,o),u=s.id,d=s.dataListItem,u&&d&&(i=Object(l.a)(Object(l.a)({},i),{},Object(f.a)({},u,d.id)))),c[n]=i,y(Object(l.a)(Object(l.a)({},x),{},{data:c}))}catch(p){console.error(p)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ye(){return(ye=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.updateExpenses(c.token,C.data[t]);case 3:u({severity:"success",message:"Record updated!",open:!0}),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0),u({severity:"error",message:"Error: Failed to save!",open:!0});case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function we(){return(we=Object(h.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.updateIncome(c.token,x.data[t]);case 3:n=e.sent,console.log(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function ke(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=Object(h.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"expenses"!==j.form){e.next=8;break}return e.next=4,G.deleteExpenses(c.token,t);case 4:n=C.data.filter((function(e){return e.entry_id!==t})),N(Object(l.a)(Object(l.a)({},C),{},{data:n})),e.next=13;break;case 8:if("income"!==j.form){e.next=13;break}return e.next=11,G.deleteIncome(c.token,t);case 11:a=x.data.filter((function(e){return e.id!==t})),y(Object(l.a)(Object(l.a)({},x),{},{data:a}));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),"Unauthorized"===e.t0&&i({type:"LOGOUT"});case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}var Se=Object(P.a)((function(e){var t;return Object(S.a)({formControl:{margin:e.spacing(1),minWidth:"7em"},selectEmpty:{marginTop:e.spacing(2)},root:(t={display:"flex",justifyContent:"center",flexWrap:"wrap"},Object(f.a)(t,e.breakpoints.up("md"),{flexWrap:"noWrap"}),Object(f.a)(t,"& > *",Object(f.a)({margin:e.spacing(1)},e.breakpoints.down("xs"),{width:"100%"})),t),wallchart:{width:"100%"},logoutBtn:{float:"right",margin:"1em"},offline:{backgroundColor:"red",color:"white",textAlign:"center",position:"sticky"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},speedDial:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)},speedDialWrapper:{position:"relative",marginTop:e.spacing(3),height:380},dialog:{width:"100%"}})}))(),Ne=[{icon:Object(a.jsx)(ge.a,{}),name:"Expenses",action:function(){R(!0),$(!1),Ae(!1)},operation:"product"},{icon:Object(a.jsx)(ge.a,{}),name:"Income",action:function(){R(!1),$(!0),Ae(!1)},operation:"tag"}],Le=o.a.useState(!1),Ee=Object(s.a)(Le,2),Ie=Ee[0],Ae=Ee[1],Te=Object(r.useState)(!1),De=Object(s.a)(Te,2),Be=De[0],Pe=De[1];return window.addEventListener("offline",(function(){return Pe(!0)})),window.addEventListener("online",(function(){return Pe(!1)})),Object(r.useEffect)((function(){function e(){return(e=Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G.dataList(c.token);case 2:t=e.sent,B(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}(),navigator.onLine||Pe(!0)}),[]),Object(a.jsxs)("div",{className:"Home",children:[Be?Object(a.jsx)(ue.a,{className:Se.offline,position:"sticky",children:"Offline"}):null,Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)(re.a,{variant:"contained",color:"primary",className:Se.logoutBtn,onClick:Object(h.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i({type:"LOGOUT"}),e.next=3,H();case 3:t=e.sent,console.log(t);case 5:case"end":return e.stop()}}),e)}))),children:"Logout"}),Object(a.jsx)(de.a,{className:Se.root,children:Object(a.jsx)("h1",{style:{textAlign:"center"},children:"Blarvis Finances"})}),c.token?Object(a.jsx)("img",{src:"/wallchart",alt:"Wall Chart",className:Se.wallchart}):null,Object(a.jsxs)(de.a,{className:Se.root,children:[M?Object(a.jsx)(se,{classes:Se,hideForms:Z}):null,V?Object(a.jsx)(le,{classes:Se,hideForms:Z}):null]}),Object(a.jsx)(de.a,{className:Se.root,children:Object(a.jsxs)(pe.a,{variant:"outlined",children:[Object(a.jsx)("h2",{className:Se.root,children:"Get Report"}),Object(a.jsxs)("form",{onSubmit:function(e){return ie.apply(this,arguments)},className:Se.root,children:[Object(a.jsxs)(ee.a,{variant:"outlined",className:Se.formControl,children:[Object(a.jsx)(te.a,{htmlFor:"form",children:"Report"}),Object(a.jsxs)(ne.a,{name:"form",label:"Report",labelId:"form",value:j.form,onChange:ce,children:[Object(a.jsx)(ae.a,{value:"income",children:"Income"}),Object(a.jsx)(ae.a,{value:"expenses",children:"Expenses"}),Object(a.jsx)(ae.a,{value:"pivot",children:"Pivot Table"})]})]}),Object(a.jsx)(X.a,{onChange:ce,value:j.year,label:"Year",name:"year",type:"number",variant:"outlined"}),Object(a.jsxs)(ee.a,{variant:"outlined",className:Se.formControl,children:[Object(a.jsx)(te.a,{htmlFor:"month2",children:"Month"}),Object(a.jsxs)(ne.a,{onChange:ce,value:j.month,name:"month",labelId:"month2",label:"Month",children:[Object(a.jsx)(ae.a,{value:1,children:"January"}),Object(a.jsx)(ae.a,{value:2,children:"February"}),Object(a.jsx)(ae.a,{value:3,children:"March"}),Object(a.jsx)(ae.a,{value:4,children:"April"}),Object(a.jsx)(ae.a,{value:5,children:"May"}),Object(a.jsx)(ae.a,{value:6,children:"June"}),Object(a.jsx)(ae.a,{value:7,children:"July"}),Object(a.jsx)(ae.a,{value:8,children:"August"}),Object(a.jsx)(ae.a,{value:9,children:"September"}),Object(a.jsx)(ae.a,{value:10,children:"October"}),Object(a.jsx)(ae.a,{value:11,children:"November"}),Object(a.jsx)(ae.a,{value:12,children:"December"})]})]}),Object(a.jsx)(re.a,{type:"submit",variant:"contained",color:"primary",children:"View"})]})]})})]}),Object(a.jsxs)("div",{className:"body",children:["income"===j.form&&(null===(e=x.data[0])||void 0===e?void 0:e.id)?Object(a.jsx)(U,{state:x,dataLists:D,handleChange:function(e,t){return xe.apply(this,arguments)},handleUpdate:function(e){return we.apply(this,arguments)},deleteEntry:ke,form:j.form}):null,"expenses"===j.form&&(null===(t=C.data[0])||void 0===t?void 0:t.entry_id)?Object(a.jsx)(U,{state:C,dataLists:D,handleChange:function(e,t){return ve.apply(this,arguments)},handleUpdate:function(e){return ye.apply(this,arguments)},deleteEntry:ke,form:j.form}):null,"pivot"===j.form&&E?Object(a.jsx)(U,{state:E,deleteEntry:function(){return null},handleUpdate:function(){return null},handleChange:function(){return null},form:j.form}):null]}),Object(a.jsx)(be.a,{ariaLabel:"SpeedDial example",className:Se.speedDial,icon:Object(a.jsx)(he.a,{}),onClose:function(){Ae(!1)},onOpen:function(){Ae(!0)},open:Ie,onMouseLeave:function(){},children:Ne.map((function(e){return Object(a.jsx)(fe.a,{icon:e.icon,tooltipTitle:e.name,tooltipOpen:!0,onClick:e.action},e.name)}))}),Object(a.jsx)(me.a,{className:Se.backdrop,open:q,children:Object(a.jsx)(je.a,{disableShrink:!0,color:"inherit"})})]})},xe=Object(P.a)((function(e){return Object(S.a)({root:{display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":Object(f.a)({margin:e.spacing(1)},e.breakpoints.down("xs"),{width:"100%"})}})}));function ye(){var e=o.a.useContext(_e),t=e.Auth,n=e.setAuth,c=e.setAlertState,i=Object(r.useState)({username:"",password:""}),u=Object(s.a)(i,2),p=u[0],m=u[1],j=function(e){var t=e.target,n=t.name,a=t.value;m(Object(l.a)(Object(l.a)({},p),{},Object(f.a)({},n,a)))},O=function(){var e=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,G.login(p).then((function(e){n({type:"LOGIN",payload:{user:p.username,token:e.token}})}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0),c({severity:"error",message:"Incorrect username or password",open:!0});case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),g=xe();return t.loggedIn?Object(a.jsx)(d.a,{to:"/"}):Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"Login",style:{textAlign:"center"},children:[Object(a.jsx)("h4",{children:"Login"}),Object(a.jsxs)("form",{className:g.root,onSubmit:O,children:[Object(a.jsx)(X.a,{onChange:j,value:p.username,type:"text",name:"username",label:"username",variant:"outlined"}),Object(a.jsx)(X.a,{onChange:j,value:p.password,type:"password",name:"password",label:"password",variant:"outlined"}),Object(a.jsx)(re.a,{variant:"contained",color:"primary",name:"login",type:"submit",children:"Login"})]})]})})}n(132);var we=n(204),ke=n(202);function Ce(e){return Object(a.jsx)(ke.a,Object(l.a)({elevation:6,variant:"filled"},e))}var Se=Object(P.a)((function(e){return{snackbar:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function Ne(e){var t=e.state,n=e.setState,r=Se(),o=function(e,a){"clickaway"!==a&&n(Object(l.a)(Object(l.a)({},t),{},{open:!1}))};return Object(a.jsx)("div",{className:r.snackbar,children:Object(a.jsx)(we.a,{open:t.open,autoHideDuration:3e3,onClose:o,children:Object(a.jsx)(Ce,{onClose:o,severity:t.severity,children:t.message})})})}var Le=function(e){var t=e.component,n=e.loggedIn,r=Object(u.a)(e,["component","loggedIn"]);return Object(a.jsx)(d.b,Object(l.a)(Object(l.a)({},r),{},{render:function(e){return n?Object(a.jsx)(t,Object(l.a)({},e)):Object(a.jsx)(d.a,{to:"/login"})}}))},_e=o.a.createContext({Auth:{loggedIn:!1,user:"",token:""},setAuth:function(){},setAlertState:function(){}});function Ee(){var e=Object(r.useReducer)((function(e,t){return"LOGIN"===t.type&&t.payload?(localStorage.setItem("user",t.payload.user),localStorage.setItem("token",t.payload.token),Object(l.a)(Object(l.a)({},e),{},{loggedIn:!0,user:t.payload.user,token:t.payload.token})):"LOGOUT"===t.type?(localStorage.clear(),Object(l.a)(Object(l.a)({},e),{},{loggedIn:!1,user:"",token:""})):e}),{loggedIn:!1,user:"",token:""}),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)({severity:void 0,message:"",open:!1}),i=Object(s.a)(c,2),u=i[0],m=i[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("token"),t=localStorage.getItem("user");e&&G.checkAuth(e).then((function(t){return o({type:"LOGIN",payload:{user:t.username,token:e}})})).catch((function(n){"Unauthorized"===n.message?o({type:"LOGOUT"}):o({type:"LOGIN",payload:{user:t||"",token:e||""}})}))}),[]),Object(r.useEffect)((function(){!function(){R.apply(this,arguments)}()})),Object(a.jsxs)(_e.Provider,{value:{Auth:n,setAuth:o,setAlertState:m},children:[Object(a.jsxs)(p.a,{children:[Object(a.jsx)(Le,{path:"/",loggedIn:n.loggedIn,setLoggedIn:o,component:ve}),Object(a.jsx)(d.b,{exact:!0,path:"/login",children:Object(a.jsx)(ye,{})})]}),Object(a.jsx)(Ne,{state:u,setState:m})]})}var Ie=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ae(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,213)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)}))};i.a.render(Object(a.jsx)(Ee,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Ie?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ae(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Ae(t,e)}))}}(),Te()}},[[133,1,2]]]);
//# sourceMappingURL=main.79cf3038.chunk.js.map