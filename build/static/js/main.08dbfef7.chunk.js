(this.webpackJsonpreact_client=this.webpackJsonpreact_client||[]).push([[0],{31:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n(1),c=n.n(r),o=n(23),s=n.n(o),i=(n(31),n(5)),u=n(2),l=n(25),d=n(3),j=n(18),b=n(11),h=n.n(b),f=n(21),m=n(15),O=n(8);function p(e){var t=Object(r.useState)({Amount:""}),n=Object(i.a)(t,2),c=n[0],o=n[1];function s(e,t){return Object(a.jsx)("datalist",{id:t,children:e.map((function(e){return Object(a.jsx)("option",{value:e.name},e.id)}))})}function l(e){var t=e.target,n=t.name,a=t.value;o(Object(u.a)(Object(u.a)({},c),{},Object(O.a)({},n,a)))}return Object(r.useEffect)((function(){o(e.entry)}),[e.entry]),Object(a.jsx)("tbody",{children:Object(a.jsxs)("tr",{children:[e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){return Object(a.jsxs)("td",{children:["Amount"===t.name?Object(a.jsx)("span",{children:"$"}):null,Object(a.jsx)("input",{name:t.name,onBlur:function(t){e.handleChange(t,e.i)},onChange:l,className:"tableInput",value:c[t.name]||"",list:t.name}),"Source"===t.name&&e.sourcesState?s(e.sourcesState,t.name):null,"Person"===t.name&&e.personsState?s(e.personsState,t.name):null,"Narrow_category"===t.name&&e.narrowState?s(e.narrowState,t.name):null,"Broad_category"===t.name&&e.broadState?s(e.broadState,t.name):null]})})),Object(a.jsx)("td",{children:Object(a.jsx)("button",{onClick:function(){return e.deleteEntry(c.entry_id||c.id)},children:"Delete"})})]})})}function x(e){return Object(a.jsx)("tbody",{children:Object(a.jsx)("tr",{children:e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){return Object(a.jsxs)("td",{children:["Amount"===t.name?Object(a.jsx)("span",{children:"$"}):null,Object(a.jsx)("span",{className:"tableInput",children:e.entry[t.name]||""})]},e.i+t.name)}))})})}function g(e){return Object(a.jsxs)("table",{children:[Object(a.jsx)("thead",{children:Object(a.jsx)("tr",{children:e.state.schema.fields.filter((function(e){return!e.name.includes("id")})).map((function(e){return Object(a.jsx)("th",{children:e.name.replace("_"," ")},e.name)}))})}),e.state.data.map((function(t,n){return"pivot"===e.form?Object(a.jsx)(x,{entry:t,i:n,fields:e.state.schema.fields},t.entry_id||t.id):Object(a.jsx)(p,{entry:t,i:n,fields:e.state.schema.fields,handleChange:e.handleChange,sourcesState:e.sourcesState,personsState:e.personsState,broadState:e.broadState,narrowState:e.narrowState,setPersonsState:e.setPersonsState,setSourcesState:e.setSourcesState,setBroadState:e.setBroadState,setNarrowState:e.setNarrowState,deleteEntry:e.deleteEntry},n)}))]})}var S={expenses:function(e,t){return fetch("/api/expenses?year=".concat(t.year,"&month=").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}})},deleteExpenses:function(e,t){return fetch("/api/expenses/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.text()}))},deleteIncome:function(e,t){return fetch("/api/income/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.text()}))},income:function(e,t){return fetch("/api/income?year=".concat(t.year,"&month=").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}})},pivot:function(e,t){return fetch("/api/pivot?year=".concat(t.year,"&month=").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}})},wallchart:function(e){return fetch("/api/wallchart",{headers:{authorization:"Bearer ".concat(e)}})},sources:function(e){return fetch("/api/sources",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},persons:function(e){return fetch("/api/persons",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},narrow:function(e){return fetch("/api/narrows",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},broad:function(e){return fetch("/api/broads",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},login:function(e){return fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))},checkAuth:function(e){return fetch("/api/checkAuth",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))}};var v=function(){var e,t,n=Object(r.useState)(""),c=Object(i.a)(n,2),o=c[0],s=c[1],l=Object(r.useState)({form:"income",year:"",month:""}),d=Object(i.a)(l,2),j=d[0],b=d[1],p=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Person:"",id:NaN,source_id:NaN,earner_id:NaN}]}),x=Object(i.a)(p,2),v=x[0],y=x[1],w=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Vendor:"",Broad_category:"",Narrow_category:"",Person:"",Notes:"",entry_id:NaN}]}),k=Object(i.a)(w,2),N=k[0],I=k[1],_=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Broad_category:"",Narrow_category:""}]}),B=Object(i.a)(_,2),L=B[0],C=B[1],E=Object(r.useState)([]),P=Object(i.a)(E,2),D=P[0],z=P[1],A=Object(r.useState)([]),F=Object(i.a)(A,2),T=F[0],Y=F[1],M=Object(r.useState)([]),J=Object(i.a)(M,2),$=J[0],R=J[1],V=Object(r.useState)([]),W=Object(i.a)(V,2),q=W[0],G=W[1];function H(e){var t=new Date(e.Date),n=t.getFullYear(),a=(1+t.getMonth()).toString();a=a.length>1?a:"0"+a;var r=t.getDate().toString(),c=a+"/"+(r=r.length>1?r:"0"+r)+"/"+n;return e.Date=c,e}function K(e){var t=e.target,n=t.name,a=t.value;b(Object(u.a)(Object(u.a)({},j),{},Object(O.a)({},n,a)))}function Q(){return(Q=Object(m.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),n=j.form,e.next=5,S[n](o,j);case 5:return e.next=7,e.sent.json();case 7:(a=e.sent).data=a.data.map(H),e.t0=n,e.next="expenses"===e.t0?12:"income"===e.t0?14:"pivot"===e.t0?16:18;break;case 12:return I(a),e.abrupt("break",18);case 14:return y(a),e.abrupt("break",18);case 16:return C(a),e.abrupt("break",18);case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(0),console.error(e.t1);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})))).apply(this,arguments)}function U(e,t){var n,a;switch(e){case"Person":n=T,a="earner_id";break;case"Source":n=D,a="source_id";break;case"Broad_category":n=$,a="broad_category_id";break;case"Narrow_category":n=q,a="narrow_category_id"}var r=n.filter((function(e){return e.name===t}))[0];return r?{id:a,dataListItem:r}:{id:null,dataListItem:null}}function X(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(m.a)(h.a.mark((function e(t){var n,a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("token"),e.prev=1,"expenses"!==j.form){e.next=9;break}return e.next=5,S.deleteExpenses(n,t);case 5:a=N.data.filter((function(e){return e.entry_id!==t})),I(Object(u.a)(Object(u.a)({},N),{},{data:a})),e.next=14;break;case 9:if("income"!==j.form){e.next=14;break}return e.next=12,S.deleteIncome(n,t);case 12:r=v.data.filter((function(e){return e.id!==t})),y(Object(u.a)(Object(u.a)({},v),{},{data:r}));case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.error(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){function e(){return(e=Object(m.a)(h.a.mark((function e(){var t,n,a,r,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=localStorage.getItem("token"))&&s(t),0!==D.length){e.next=8;break}return e.next=5,S.sources(t);case 5:n=e.sent,a=n.data,z(a);case 8:if(0!==T.length){e.next=13;break}return e.next=11,S.persons(t);case 11:r=e.sent,Y(r.data);case 13:if(0!==q.length){e.next=18;break}return e.next=16,S.narrow(t);case 16:c=e.sent,G(c.data);case 18:if(0!==$.length){e.next=23;break}return e.next=21,S.broad(t);case 21:o=e.sent,R(o.data);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(a.jsxs)("div",{className:"App",children:[Object(a.jsxs)("div",{className:"header",children:[Object(a.jsx)("button",{className:"logout",onClick:function(){localStorage.removeItem("token"),window.location.reload()},children:"Logout"}),Object(a.jsx)("h1",{children:"Finances!"}),o?Object(a.jsx)("img",{src:"/api/wallchart",alt:"Wall Chart"}):null,Object(a.jsxs)("form",{onSubmit:function(e){return Q.apply(this,arguments)},className:"form-inline",children:[Object(a.jsxs)("select",{name:"form",value:j.form,onChange:K,children:[Object(a.jsx)("option",{value:"income",children:"Income"}),Object(a.jsx)("option",{value:"expenses",children:"Expenses"}),Object(a.jsx)("option",{value:"pivot",children:"Pivot Table"})]}),Object(a.jsx)("label",{htmlFor:"year2",children:"Year"}),Object(a.jsx)("input",{onChange:K,value:j.year,type:"text",id:"year2",className:"form-control",name:"year",placeholder:"YYYY"}),Object(a.jsx)("label",{htmlFor:"month2",children:"Month"}),Object(a.jsx)("input",{onChange:K,value:j.month,type:"text",id:"month2",className:"form-control",name:"month",placeholder:"MM"}),Object(a.jsx)("button",{className:"btn btn-success",children:"Submit"})]})]}),"income"===j.form&&(null===(e=v.data[0])||void 0===e?void 0:e.id)?Object(a.jsx)(g,{state:v,sourcesState:D,personsState:T,handleChange:function(e,t){var n=e.target,a=n.name,r=n.value,c=Object(f.a)(v.data),o=Object(u.a)(Object(u.a)({},c[t]),{},Object(O.a)({},a,r));if("Person"===a||"Source"===a){var s=U(a,r),i=s.id,l=s.dataListItem;i&&l&&(o=Object(u.a)(Object(u.a)({},o),{},Object(O.a)({},i,l.id)))}c[t]=o,y(Object(u.a)(Object(u.a)({},v),{},{data:c}))},setSourcesState:z,setPersonsState:Y,deleteEntry:X,form:j.form}):null,"expenses"===j.form&&(null===(t=N.data[0])||void 0===t?void 0:t.entry_id)?Object(a.jsx)(g,{state:N,personsState:T,broadState:$,narrowState:q,handleChange:function(e,t){var n=e.target,a=n.name,r=n.value,c=Object(f.a)(N.data),o=Object(u.a)(Object(u.a)({},c[t]),{},Object(O.a)({},a,r));if("Person"===a||"Broad_category"===a||"Narrow_category"===a){var s=U(a,r),i=s.id,l=s.dataListItem;i&&l&&(o=Object(u.a)(Object(u.a)({},o),{},Object(O.a)({},i,l.id)))}c[t]=o,I(Object(u.a)(Object(u.a)({},N),{},{data:c}))},setPersonsState:Y,setBroadState:R,setNarrowState:G,deleteEntry:X,form:j.form}):null,"pivot"===j.form&&L?Object(a.jsx)(g,{state:L,deleteEntry:X,handleChange:function(){return!1},form:j.form}):null]})};function y(e){var t=Object(r.useState)({username:"",password:""}),n=Object(i.a)(t,2),c=n[0],o=n[1],s=Object(r.useState)(!1),l=Object(i.a)(s,2),j=l[0],b=l[1],h=function(e){var t=e.target,n=t.name,a=t.value;o(Object(u.a)(Object(u.a)({},c),{},Object(O.a)({},n,a)))};return e.isLoggedIn?Object(a.jsx)(d.a,{to:"/"}):Object(a.jsx)(a.Fragment,{children:Object(a.jsx)("div",{className:"Login",children:Object(a.jsxs)("form",{className:"LoginForm",onSubmit:function(t){t.preventDefault(),S.login(c).then((function(t){localStorage.setItem("token",t.token),e.setIsLoggedIn(!0)})).catch((function(e){return b(!0)}))},children:[Object(a.jsx)("h4",{children:"Login"}),Object(a.jsx)("div",{className:"Response",children:j?Object(a.jsx)("p",{children:"Incorrect username or password"}):null}),Object(a.jsx)("input",{onChange:h,value:c.username,type:"text",name:"username",placeholder:"username"}),Object(a.jsx)("input",{onChange:h,value:c.password,type:"password",name:"password",placeholder:"password"}),Object(a.jsx)("button",{className:"Btn",name:"login",type:"submit",children:"Login"})]})})})}n(38);var w=function(e){var t=e.component,n=e.isLoggedIn,r=Object(l.a)(e,["component","isLoggedIn"]);return Object(a.jsx)(d.b,Object(u.a)(Object(u.a)({},r),{},{render:function(e){return n?Object(a.jsx)(t,Object(u.a)({},e)):Object(a.jsx)(d.a,{to:"/login"})}}))};function k(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("token");S.checkAuth(e).then((function(e){return c(!0)})).catch((function(e){c(!1),localStorage.removeItem("token")}))}),[]),Object(a.jsxs)(j.a,{children:[Object(a.jsx)(w,{path:"/",isLoggedIn:n,setIsLoggedIn:c,component:v}),Object(a.jsx)(d.b,{exact:!0,path:"/login",children:Object(a.jsx)(y,{isLoggedIn:n,setIsLoggedIn:c})})]})}var N=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,40)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(k,{})}),document.getElementById("root")),N()}},[[39,1,2]]]);
//# sourceMappingURL=main.08dbfef7.chunk.js.map