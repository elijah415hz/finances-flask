(this.webpackJsonpreact_client=this.webpackJsonpreact_client||[]).push([[0],{31:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(0),c=a.n(r),o=a(23),s=a.n(o),i=(a(31),a(5)),u=a(2),l=a(25),j=a(3),d=a(17),b=a(13),h=a.n(b),m=a(21),O=a(18),f=a(8);function p(e){var t=Object(r.useState)(e.entry),a=Object(i.a)(t,2),c=a[0],o=a[1];function s(e,t){return Object(n.jsx)("datalist",{id:t,children:e.map((function(e){return Object(n.jsx)("option",{value:e.name},e.id)}))})}function l(e){var t=e.target,a=t.name,n=t.value;o(Object(u.a)(Object(u.a)({},c),{},Object(f.a)({},a,n)))}return Object(n.jsx)("tbody",{children:Object(n.jsx)("tr",{children:e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){return Object(n.jsxs)("td",{children:["Amount"===t.name?Object(n.jsx)("span",{children:"$"}):null,Object(n.jsx)("input",{name:t.name,onBlur:function(t){e.handleChange?e.handleChange(t,e.i):console.log("nothing")},onChange:c.Person?l:void 0,className:"tableInput",value:c[t.name]||"",list:t.name}),"Source"===t.name&&e.sourcesState?s(e.sourcesState,t.name):null,"Person"===t.name&&e.personsState?s(e.personsState,t.name):null,"Narrow_category"===t.name&&e.narrowState?s(e.narrowState,t.name):null,"Broad_category"===t.name&&e.broadState?s(e.broadState,t.name):null]},e.i+t.name)}))})})}function g(e){return Object(n.jsxs)("table",{children:[Object(n.jsx)("thead",{children:Object(n.jsx)("tr",{children:e.state.schema.fields.filter((function(e){return!e.name.includes("id")})).map((function(e){return Object(n.jsx)("th",{children:e.name.replace("_"," ")},e.name)}))})}),e.state.data.map((function(t,a){return Object(n.jsx)(p,{entry:t,i:a,fields:e.state.schema.fields,handleChange:e.handleChange,sourcesState:e.sourcesState,personsState:e.personsState,broadState:e.broadState,narrowState:e.narrowState,setPersonsState:e.setPersonsState,setSourcesState:e.setSourcesState,setBroadState:e.setBroadState,setNarrowState:e.setNarrowState},a)}))]})}var x={expenses:function(e,t){return fetch("/api/expenses?year=".concat(t.year,"&month=").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}})},income:function(e,t){return fetch("/api/income?year=".concat(t.year,"&month=").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}})},pivot:function(e,t){return fetch("/api/pivot?year=".concat(t.year,"&month=").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}})},wallchart:function(e){return fetch("/api/wallchart",{headers:{authorization:"Bearer ".concat(e)}})},sources:function(e){return fetch("/api/sources",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},persons:function(e){return fetch("/api/persons",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},narrow:function(e){return fetch("/api/narrows",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},broad:function(e){return fetch("/api/broads",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))},login:function(e){return fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))},checkAuth:function(e){return fetch("/api/checkAuth",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()}))}};var S=function(){var e,t,a=Object(r.useState)(""),c=Object(i.a)(a,2),o=c[0],s=c[1],l=Object(r.useState)({form:"income",year:"",month:""}),j=Object(i.a)(l,2),d=j[0],b=j[1],p=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Person:"",id:NaN,source_id:NaN,earner_id:NaN}]}),S=Object(i.a)(p,2),v=S[0],y=S[1],w=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Vendor:"",Broad_category:"",Narrow_category:"",Person:"",Notes:"",entry_id:NaN}]}),N=Object(i.a)(w,2),k=N[0],I=N[1],_=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Broad_category:"",Narrow_category:""}]}),B=Object(i.a)(_,2),L=B[0],C=B[1],P=Object(r.useState)([]),F=Object(i.a)(P,2),z=F[0],D=F[1],A=Object(r.useState)([]),Y=Object(i.a)(A,2),M=Y[0],T=Y[1],E=Object(r.useState)([]),J=Object(i.a)(E,2),R=J[0],V=J[1],W=Object(r.useState)([]),$=Object(i.a)(W,2),q=$[0],G=$[1];function H(e){var t=new Date(e.Date),a=t.getFullYear(),n=(1+t.getMonth()).toString();n=n.length>1?n:"0"+n;var r=t.getDate().toString(),c=n+"/"+(r=r.length>1?r:"0"+r)+"/"+a;return e.Date=c,e}function K(e){var t=e.target,a=t.name,n=t.value;b(Object(u.a)(Object(u.a)({},d),{},Object(f.a)({},a,n)))}function Q(){return(Q=Object(O.a)(h.a.mark((function e(t){var a,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),a=d.form,e.next=5,x[a](o,d);case 5:return e.next=7,e.sent.json();case 7:(n=e.sent).data=n.data.map(H),console.log(n),e.t0=a,e.next="expenses"===e.t0?13:"income"===e.t0?15:"pivot"===e.t0?17:19;break;case 13:return I(n),e.abrupt("break",19);case 15:return y(n),e.abrupt("break",19);case 17:return C(n),e.abrupt("break",19);case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(0),console.error(e.t1);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})))).apply(this,arguments)}function U(e,t){var a,n;switch(e){case"Person":a=M,n="earner_id";break;case"Source":a=z,n="source_id";break;case"Broad_category":a=R,n="broad_category_id";break;case"Narrow_category":a=q,n="narrow_category_id"}var r=a.filter((function(e){return e.name===t}))[0];return r?{id:n,dataListItem:r}:{id:null,dataListItem:null}}return Object(r.useEffect)((function(){function e(){return(e=Object(O.a)(h.a.mark((function e(){var t,a,n,r,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=localStorage.getItem("token"))&&s(t),0!==z.length){e.next=8;break}return e.next=5,x.sources(t);case 5:a=e.sent,n=a.data,D(n);case 8:if(0!==M.length){e.next=13;break}return e.next=11,x.persons(t);case 11:r=e.sent,T(r.data);case 13:if(0!==q.length){e.next=18;break}return e.next=16,x.narrow(t);case 16:c=e.sent,G(c.data);case 18:if(0!==R.length){e.next=23;break}return e.next=21,x.broad(t);case 21:o=e.sent,V(o.data);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsxs)("div",{className:"header",children:[Object(n.jsx)("button",{className:"logout",onClick:function(){localStorage.removeItem("token"),window.location.reload()},children:"Logout"}),Object(n.jsx)("h1",{children:"Finances!"}),o?Object(n.jsx)("img",{src:"/api/wallchart",alt:"Wall Chart"}):null,Object(n.jsxs)("form",{onSubmit:function(e){return Q.apply(this,arguments)},className:"form-inline",children:[Object(n.jsxs)("select",{name:"form",value:d.form,onChange:K,children:[Object(n.jsx)("option",{value:"income",children:"Income"}),Object(n.jsx)("option",{value:"expenses",children:"Expenses"}),Object(n.jsx)("option",{value:"pivot",children:"Pivot Table"})]}),Object(n.jsx)("label",{htmlFor:"year2",children:"Year"}),Object(n.jsx)("input",{onChange:K,value:d.year,type:"text",id:"year2",className:"form-control",name:"year",placeholder:"YYYY"}),Object(n.jsx)("label",{htmlFor:"month2",children:"Month"}),Object(n.jsx)("input",{onChange:K,value:d.month,type:"text",id:"month2",className:"form-control",name:"month",placeholder:"MM"}),Object(n.jsx)("button",{className:"btn btn-success",children:"Submit"})]})]}),"income"===d.form&&(null===(e=v.data[0])||void 0===e?void 0:e.id)?Object(n.jsx)(g,{state:v,sourcesState:z,personsState:M,handleChange:function(e,t){var a=e.target,n=a.name,r=a.value,c=Object(m.a)(v.data),o=Object(u.a)(Object(u.a)({},c[t]),{},Object(f.a)({},n,r));if("Person"===n||"Source"===n){var s=U(n,r),i=s.id,l=s.dataListItem;i&&l&&(o=Object(u.a)(Object(u.a)({},o),{},Object(f.a)({},i,l.id)))}c[t]=o,y(Object(u.a)(Object(u.a)({},v),{},{data:c}))},setSourcesState:D,setPersonsState:T}):null,"expenses"===d.form&&(null===(t=k.data[0])||void 0===t?void 0:t.entry_id)?Object(n.jsx)(g,{state:k,personsState:M,broadState:R,narrowState:q,handleChange:function(e,t){var a=e.target,n=a.name,r=a.value,c=Object(m.a)(k.data),o=Object(u.a)(Object(u.a)({},c[t]),{},Object(f.a)({},n,r));if("Person"===n||"Broad_category"===n||"Narrow_category"===n){var s=U(n,r),i=s.id,l=s.dataListItem;i&&l&&(o=Object(u.a)(Object(u.a)({},o),{},Object(f.a)({},i,l.id)))}c[t]=o,I(Object(u.a)(Object(u.a)({},k),{},{data:c}))},setPersonsState:T,setBroadState:V,setNarrowState:G}):null,"pivot"===d.form&&L?Object(n.jsx)(g,{state:L}):null]})};function v(e){var t=Object(r.useState)({username:"",password:""}),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(r.useState)(!1),l=Object(i.a)(s,2),d=l[0],b=l[1],h=function(e){var t=e.target,a=t.name,n=t.value;o(Object(u.a)(Object(u.a)({},c),{},Object(f.a)({},a,n)))};return e.isLoggedIn?Object(n.jsx)(j.a,{to:"/"}):Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("div",{className:"Login",children:Object(n.jsxs)("form",{className:"LoginForm",onSubmit:function(t){t.preventDefault(),console.log(c),x.login(c).then((function(t){localStorage.setItem("token",t.token),e.setIsLoggedIn(!0)})).catch((function(e){return b(!0)}))},children:[Object(n.jsx)("h4",{children:"Login"}),Object(n.jsx)("div",{className:"Response",children:d?Object(n.jsx)("p",{children:"Incorrect username or password"}):null}),Object(n.jsx)("input",{onChange:h,value:c.username,type:"text",name:"username",placeholder:"username"}),Object(n.jsx)("input",{onChange:h,value:c.password,type:"password",name:"password",placeholder:"password"}),Object(n.jsx)("button",{className:"Btn",name:"login",type:"submit",children:"Login"})]})})})}a(38);var y=function(e){var t=e.component,a=e.isLoggedIn,r=Object(l.a)(e,["component","isLoggedIn"]);return Object(n.jsx)(j.b,Object(u.a)(Object(u.a)({},r),{},{render:function(e){return a?Object(n.jsx)(t,Object(u.a)({},e)):Object(n.jsx)(j.a,{to:"/login"})}}))};function w(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("token");x.checkAuth(e).then((function(e){return c(!0)})).catch((function(e){c(!1),localStorage.removeItem("token")}))}),[]),Object(n.jsxs)(d.a,{children:[Object(n.jsx)(y,{path:"/",isLoggedIn:a,setIsLoggedIn:c,component:S}),Object(n.jsx)(j.b,{exact:!0,path:"/login",children:Object(n.jsx)(v,{isLoggedIn:a,setIsLoggedIn:c})})]})}var N=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,40)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;a(e),n(e),r(e),c(e),o(e)}))};s.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(w,{})}),document.getElementById("root")),N()}},[[39,1,2]]]);
//# sourceMappingURL=main.eca707e7.chunk.js.map