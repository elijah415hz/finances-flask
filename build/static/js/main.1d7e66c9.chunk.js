(this.webpackJsonpreact_client=this.webpackJsonpreact_client||[]).push([[0],{89:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n.n(r),o=n(11),i=n.n(o),s=(n(89),n(18)),u=n(7),l=n(75),d=n(13),j=n(59),h=n(62),b=n(16),p=n.n(b),f=n(26),m=n(22),O=n(74),x=n.n(O),v=n(73),g=n.n(v),y=n(136),k=n(137),w=n(138),C=n(5),L=n(150),_=Object(C.a)((function(e){return Object(L.a)({head:{backgroundColor:e.palette.common.black,color:e.palette.common.white},body:{fontSize:14,padding:0,maxWidth:"10ch"}})}))(y.a),N=Object(C.a)((function(e){return Object(L.a)({root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"& input":{backgroundColor:"inherit",paddingLeft:0}}})}))(k.a);function I(e){var t=Object(r.useState)({Amount:""}),n=Object(s.a)(t,2),c=n[0],o=n[1];function i(e,t){return Object(a.jsx)("datalist",{id:t,children:e.map((function(e){return Object(a.jsx)("option",{value:e.name},e.id)}))})}function l(e){var t=e.target,n=t.name,a=t.value;o(Object(u.a)(Object(u.a)({},c),{},Object(m.a)({},n,a)))}return Object(r.useEffect)((function(){o(e.entry)}),[e.entry]),Object(a.jsxs)(N,{children:[e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){var n,r,o,s,u,d,j,h,b,p;return Object(a.jsxs)(_,{children:["Amount"===t.name?Object(a.jsx)("span",{children:"$"}):null,Object(a.jsx)("input",{name:t.name,onBlur:function(t){e.handleChange(t,e.i)},onChange:l,className:"tableInput",value:c[t.name]||"",list:t.name,style:{width:"80%"}}),"Source"===t.name&&(null===(n=e.dataLists)||void 0===n?void 0:n.source)?i(null===(r=e.dataLists)||void 0===r?void 0:r.source,t.name):null,"Person"===t.name&&(null===(o=e.dataLists)||void 0===o?void 0:o.person_earner)?i(null===(s=e.dataLists)||void 0===s?void 0:s.person_earner,t.name):null,"Narrow_category"===t.name&&(null===(u=e.dataLists)||void 0===u?void 0:u.narrow_category)?i(null===(d=e.dataLists)||void 0===d?void 0:d.narrow_category,t.name):null,"Broad_category"===t.name&&(null===(j=e.dataLists)||void 0===j?void 0:j.broad_category)?i(null===(h=e.dataLists)||void 0===h?void 0:h.broad_category,t.name):null,"Vendor"===t.name&&(null===(b=e.dataLists)||void 0===b?void 0:b.vendor)?i(null===(p=e.dataLists)||void 0===p?void 0:p.vendor,t.name):null]})})),Object(a.jsx)(_,{children:Object(a.jsx)(w.a,{color:"primary",onClick:function(){return e.handleUpdate(e.i)},children:Object(a.jsx)(g.a,{})})}),Object(a.jsx)(_,{children:Object(a.jsx)(w.a,{"aria-label":"delete",color:"secondary",onClick:function(){return e.deleteEntry(c.entry_id||c.id)},children:Object(a.jsx)(x.a,{})})})]})}function S(e){return Object(a.jsx)("tbody",{children:Object(a.jsx)("tr",{children:e.fields.filter((function(e){return!e.name.includes("id")})).map((function(t){return Object(a.jsxs)("td",{children:["Amount"===t.name?Object(a.jsx)("span",{children:"$"}):null,Object(a.jsx)("span",{className:"tableInput",children:e.entry[t.name]||""})]},e.i+t.name)}))})})}var T=n(142),U=n(144),E=n(140),A=n(143),B=n(141),D=n(139);function z(e){var t=Object(C.a)((function(e){return Object(L.a)({head:{backgroundColor:e.palette.primary.main,color:e.palette.common.white}})}))(y.a),n=Object(D.a)((function(e){return Object(L.a)({table:{minWidth:650}})}))();return Object(a.jsx)(E.a,{component:B.a,children:Object(a.jsxs)(T.a,{className:n.table,children:[Object(a.jsx)(A.a,{children:Object(a.jsxs)(k.a,{children:[e.state.schema.fields.filter((function(e){return!e.name.includes("id")})).map((function(e){return Object(a.jsx)(t,{children:e.name.replace("_"," ")},e.name)})),Object(a.jsx)(t,{children:Object(a.jsx)("span",{children:"Save"})}),Object(a.jsx)(t,{children:Object(a.jsx)("span",{children:"Delete"})})]})}),Object(a.jsx)(U.a,{className:"tableBody",children:e.state.data.map((function(t,n){return"pivot"===e.form?Object(a.jsx)(S,{entry:t,i:n,fields:e.state.schema.fields},t.entry_id||t.id):Object(a.jsx)(I,{entry:t,i:n,fields:e.state.schema.fields,handleChange:e.handleChange,handleUpdate:e.handleUpdate,dataLists:e.dataLists,deleteEntry:e.deleteEntry},n)}))})]})})}function P(e,t){if(401===e.status)throw new Error("Unauthorized");return"json"===t?e.json():e.text()}var F={expenses:function(e,t){return fetch("/api/expenses/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"json")}))},deleteExpenses:function(e,t){return fetch("/api/expenses/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"text")}))},updateExpenses:function(e,t){return fetch("/api/expenses/".concat(t.entry_id),{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return P(e,"text")}))},income:function(e,t){return fetch("/api/income/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"json")}))},updateIncome:function(e,t){return fetch("/api/income/".concat(t.id),{method:"PUT",headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return P(e,"text")}))},deleteIncome:function(e,t){return fetch("/api/income/".concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"text")}))},pivot:function(e,t){return fetch("/api/expenses/pivot/".concat(t.year,"/").concat(t.month),{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"json")}))},dataList:function(e){return fetch("/api/datalists",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"json")}))},login:function(e){return fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return P(e,"json")}))},checkAuth:function(e){return fetch("/auth/checkAuth",{headers:{authorization:"Bearer ".concat(e)}}).then((function(e){return P(e,"json")}))}},G=n(145),J=n(146),W=n(151),M=n(149),R=n(153),V=n(154);var Y=function(){var e,t,n=c.a.useContext(K),o=n.Auth,i=n.setAuth,l=Object(r.useState)({form:"expenses",year:new Date(Date.now()).getUTCFullYear(),month:new Date(Date.now()).getUTCMonth()}),d=Object(s.a)(l,2),j=d[0],b=d[1],O=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Person:"",id:NaN,source_id:NaN,earner_id:NaN}]}),x=Object(s.a)(O,2),v=x[0],g=x[1],y=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Date:"",Source:"",Vendor:"",Broad_category:"",Narrow_category:"",Person:"",Notes:"",entry_id:NaN}]}),k=Object(s.a)(y,2),w=k[0],C=k[1],_=Object(r.useState)({schema:{fields:[]},data:[{Amount:"",Broad_category:"",Narrow_category:""}]}),N=Object(s.a)(_,2),I=N[0],S=N[1],T=Object(r.useState)({source:[],person_earner:[],narrow_category:[],broad_category:[],vendor:[]}),U=Object(s.a)(T,2),E=U[0],A=U[1];function B(e){if(e.Date){var t=new Date(e.Date),n=t.getUTCFullYear(),a=(1+t.getUTCMonth()).toString();a=a.length>1?a:"0"+a;var r=t.getUTCDate().toString(),c=a+"/"+(r=r.length>1?r:"0"+r)+"/"+n;return e.Date=c,e}return e}function P(e){var t=e.target.name;b(Object(u.a)(Object(u.a)({},j),{},Object(m.a)({},t,e.target.value)))}function Y(){return(Y=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),n=j.form,e.next=5,F[n](o.token,j);case 5:a=e.sent,"pivot"!==n&&(a.data=a.data.map(B)),e.t0=n,e.next="expenses"===e.t0?10:"income"===e.t0?12:"pivot"===e.t0?14:16;break;case 10:return C(a),e.abrupt("break",16);case 12:return g(a),e.abrupt("break",16);case 14:return S(a),e.abrupt("break",16);case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),"Unauthorized"===e.t1.message&&i({type:"LOGOUT"});case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function $(e,t){var n,a;switch(e){case"Person":n=E.person_earner,a="person_id";break;case"Source":n=E.source,a="source_id";break;case"Broad_category":n=E.broad_category,a="broad_category_id";break;case"Narrow_category":n=E.narrow_category,a="narrow_category_id";break;case"Vendor":n=E.vendor,a="vendor_id"}var r=n.filter((function(e){return e.name===t}))[0];return r?{id:a,dataListItem:r}:{id:null,dataListItem:null}}function H(){return(H=Object(f.a)(p.a.mark((function e(t,n){var a,r,c,o,s,l,d,j;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a=t.target,r=a.name,c=a.value,o=Object(h.a)(w.data),s=Object(u.a)(Object(u.a)({},o[n]),{},Object(m.a)({},r,c)),"Person"!==r&&"Broad_category"!==r&&"Narrow_category"!==r&&"Vendor"!==r||(l=$(r,c),d=l.id,j=l.dataListItem,d&&j&&(s=Object(u.a)(Object(u.a)({},s),{},Object(m.a)({},d,j.id)))),o[n]=s,C(Object(u.a)(Object(u.a)({},w),{},{data:o}))}catch(b){console.error(b),"Unauthorized"===b.message&&i({type:"LOGOUT"})}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.updateExpenses(o.token,w.data[t]);case 3:n=e.sent,console.log(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Q(){return(Q=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.updateIncome(o.token,v.data[t]);case 3:n=e.sent,console.log(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function X(){return(X=Object(f.a)(p.a.mark((function e(t,n){var a,r,c,o,s,l,d,j;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{a=t.target,r=a.name,c=a.value,o=Object(h.a)(v.data),s=Object(u.a)(Object(u.a)({},o[n]),{},Object(m.a)({},r,c)),"Person"!==r&&"Source"!==r||(l=$(r,c),d=l.id,j=l.dataListItem,d&&j&&(s=Object(u.a)(Object(u.a)({},s),{},Object(m.a)({},d,j.id)))),o[n]=s,g(Object(u.a)(Object(u.a)({},v),{},{data:o}))}catch(b){console.error(b),"Unauthorized"===b.message&&i({type:"LOGOUT"})}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return ee.apply(this,arguments)}function ee(){return(ee=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"expenses"!==j.form){e.next=8;break}return e.next=4,F.deleteExpenses(o.token,t);case 4:n=w.data.filter((function(e){return e.entry_id!==t})),C(Object(u.a)(Object(u.a)({},w),{},{data:n})),e.next=13;break;case 8:if("income"!==j.form){e.next=13;break}return e.next=11,F.deleteIncome(o.token,t);case 11:a=v.data.filter((function(e){return e.id!==t})),g(Object(u.a)(Object(u.a)({},v),{},{data:a}));case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),"Unauthorized"===e.t0&&i({type:"LOGOUT"});case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}var te=Object(D.a)((function(e){return Object(L.a)({formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)},root:{display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":{margin:e.spacing(1),width:"15ch"}}})}))();return Object(r.useEffect)((function(){function e(){return(e=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.dataList(o.token);case 2:t=e.sent,A(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(a.jsxs)("div",{className:"Home",children:[Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)(G.a,{variant:"contained",color:"primary",className:"logout",onClick:function(){return i({type:"LOGOUT"})},children:"Logout"}),Object(a.jsx)("h1",{style:{textAlign:"center"},children:"Finances!"}),o.token?Object(a.jsx)("img",{src:"/wallchart",alt:"Wall Chart"}):null,Object(a.jsxs)("form",{onSubmit:function(e){return Y.apply(this,arguments)},className:te.root,children:[Object(a.jsxs)(J.a,{variant:"outlined",className:te.formControl,children:[Object(a.jsx)(W.a,{htmlFor:"form",children:"Report"}),Object(a.jsxs)(M.a,{name:"form",label:"Report",labelId:"form",value:j.form,onChange:P,children:[Object(a.jsx)(R.a,{value:"income",children:"Income"}),Object(a.jsx)(R.a,{value:"expenses",children:"Expenses"}),Object(a.jsx)(R.a,{value:"pivot",children:"Pivot Table"})]})]}),Object(a.jsx)(V.a,{onChange:P,value:j.year,label:"Year",name:"year",type:"number",variant:"outlined"}),Object(a.jsxs)(J.a,{variant:"outlined",className:te.formControl,children:[Object(a.jsx)(W.a,{htmlFor:"month2",children:"Month"}),Object(a.jsxs)(M.a,{onChange:P,value:j.month,name:"month",labelId:"month2",label:"Month",children:[Object(a.jsx)(R.a,{value:1,children:"January"}),Object(a.jsx)(R.a,{value:2,children:"February"}),Object(a.jsx)(R.a,{value:3,children:"March"}),Object(a.jsx)(R.a,{value:4,children:"April"}),Object(a.jsx)(R.a,{value:5,children:"May"}),Object(a.jsx)(R.a,{value:6,children:"June"}),Object(a.jsx)(R.a,{value:7,children:"July"}),Object(a.jsx)(R.a,{value:8,children:"August"}),Object(a.jsx)(R.a,{value:9,children:"September"}),Object(a.jsx)(R.a,{value:10,children:"October"}),Object(a.jsx)(R.a,{value:11,children:"November"}),Object(a.jsx)(R.a,{value:12,children:"December"})]})]}),Object(a.jsx)(G.a,{type:"submit",variant:"contained",color:"primary",children:"Submit"})]})]}),Object(a.jsxs)("div",{className:"body",children:["income"===j.form&&(null===(e=v.data[0])||void 0===e?void 0:e.id)?Object(a.jsx)(z,{state:v,dataLists:E,handleChange:function(e,t){return X.apply(this,arguments)},handleUpdate:function(e){return Q.apply(this,arguments)},deleteEntry:Z,form:j.form}):null,"expenses"===j.form&&(null===(t=w.data[0])||void 0===t?void 0:t.entry_id)?Object(a.jsx)(z,{state:w,dataLists:E,handleChange:function(e,t){return H.apply(this,arguments)},handleUpdate:function(e){return q.apply(this,arguments)},deleteEntry:Z,form:j.form}):null,"pivot"===j.form&&I?Object(a.jsx)(z,{state:I,deleteEntry:function(){return null},handleUpdate:function(){return null},handleChange:function(){return null},form:j.form}):null]})]})},$=Object(D.a)((function(e){return Object(L.a)({formControl:{margin:e.spacing(1),minWidth:120},root:{display:"flex",justifyContent:"center",flexWrap:"wrap","& > *":{margin:e.spacing(1),width:"15ch"}}})}));function H(){var e=c.a.useContext(K),t=e.Auth,n=e.setAuth,o=Object(r.useState)({username:"",password:""}),i=Object(s.a)(o,2),l=i[0],j=i[1],h=Object(r.useState)(!1),b=Object(s.a)(h,2),O=b[0],x=b[1],v=function(e){var t=e.target,n=t.name,a=t.value;j(Object(u.a)(Object(u.a)({},l),{},Object(m.a)({},n,a)))},g=function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{F.login(l).then((function(e){console.log("Login Token: "+e.token),n({type:"LOGIN",payload:{user:l.username,token:e.token}})}))}catch(a){console.log(a),x(!0)}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=$();return t.loggedIn?Object(a.jsx)(d.a,{to:"/"}):Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)("div",{className:"Login",style:{textAlign:"center"},children:[Object(a.jsx)("h4",{children:"Login"}),Object(a.jsx)("div",{className:"Response",children:O?Object(a.jsx)("p",{children:"Incorrect username or password"}):null}),Object(a.jsxs)("form",{className:y.root,onSubmit:g,children:[Object(a.jsx)(V.a,{onChange:v,value:l.username,type:"text",name:"username",label:"username",variant:"outlined"}),Object(a.jsx)(V.a,{onChange:v,value:l.password,type:"password",name:"password",label:"password",variant:"outlined"}),Object(a.jsx)(G.a,{variant:"contained",color:"primary",name:"login",type:"submit",children:"Login"})]})]})})}n(97);var q=function(e){var t=e.component,n=e.loggedIn,r=Object(l.a)(e,["component","loggedIn"]);return Object(a.jsx)(d.b,Object(u.a)(Object(u.a)({},r),{},{render:function(e){return n?Object(a.jsx)(t,Object(u.a)({},e)):Object(a.jsx)(d.a,{to:"/login"})}}))},K=c.a.createContext({Auth:{loggedIn:!1,user:"",token:""},setAuth:function(){}}),Q=function(e,t){return"LOGIN"===t.type&&t.payload?(localStorage.setItem("user",t.payload.user),localStorage.setItem("token",t.payload.token),Object(u.a)(Object(u.a)({},e),{},{loggedIn:!0,user:t.payload.user,token:t.payload.token})):"LOGOUT"===t.type?(localStorage.clear(),Object(u.a)(Object(u.a)({},e),{},{loggedIn:!1,user:"",token:""})):e};function X(){var e=c.a.useReducer(Q,{loggedIn:!1,user:"",token:""}),t=Object(s.a)(e,2),n=t[0],o=t[1];return Object(r.useEffect)((function(){var e=localStorage.getItem("token");e&&F.checkAuth(e).then((function(t){return o({type:"LOGIN",payload:{user:t.username,token:e}})})).catch((function(e){}))}),[]),Object(a.jsx)(K.Provider,{value:{Auth:n,setAuth:o},children:Object(a.jsxs)(j.a,{children:[Object(a.jsx)(q,{path:"/",loggedIn:n.loggedIn,setLoggedIn:o,component:Y}),Object(a.jsx)(d.b,{exact:!0,path:"/login",children:Object(a.jsx)(H,{})})]})})}var Z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,155)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),c(e),o(e)}))};i.a.render(Object(a.jsx)(X,{}),document.getElementById("root")),Z()}},[[98,1,2]]]);
//# sourceMappingURL=main.1d7e66c9.chunk.js.map